<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Solana Multi-Wallet Signing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Solana Wallet Adapter UMD bundles and dependencies -->
  <script src="https://unpkg.com/@solana/wallet-adapter-wallets@0.21.12/dist/umd/index.min.js"></script>
  <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Inter:400,600&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(120deg, #2b5876 0%, #4e4376 100%);
      min-height: 100vh;
      margin: 0;
      font-family: 'Inter', Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .main-card {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 10px 32px 0 #2b587640, 0 0 0 1.5px #4e43760f;
      padding: 36px 32px 32px 32px;
      width: 100%;
      max-width: 420px;
      margin: 32px 0;
      animation: fadeIn 0.7s;
    }
    @keyframes fadeIn {
      from {opacity:0; transform: translateY(30px);}
      to {opacity:1; transform: translateY(0);}
    }
    .logo-row {
      text-align: center;
      margin-bottom: 12px;
    }
    .logo-row img {
      height: 40px;
      margin-bottom: 6px;
    }
    h2 {
      font-weight: 700;
      color: #22223b;
      font-size: 1.7em;
      text-align: center;
      letter-spacing: -1px;
      margin: 0 0 18px 0;
    }
    .field-label {
      font-weight: 600;
      font-size: 1em;
      margin-bottom: 4px;
      color: #22223b;
      display: block;
      letter-spacing: 0.01em;
    }
    .select-wallet-row {
      margin-bottom: 18px;
    }
    select, input[type=text] {
      width: 100%;
      padding: 11px 12px;
      border: 1.5px solid #e0e0e0;
      border-radius: 7px;
      background: #f5f5f7;
      font-size: 1.04em;
      color: #22223b;
      margin-bottom: 8px;
      box-sizing: border-box;
      transition: border .2s;
    }
    select:focus, input:focus {
      border: 1.5px solid #5f39e4;
      outline: none;
      background: #f3eaff;
    }
    button {
      width: 100%;
      padding: 12px 0;
      margin-bottom: 8px;
      font-size: 1.13em;
      font-weight: 700;
      border-radius: 7px;
      border: none;
      background: linear-gradient(90deg, #6a82fb 0%, #fc5c7d 100%);
      color: #fff;
      box-shadow: 0 2px 8px #6a82fb33;
      cursor: pointer;
      transition: background .2s, box-shadow .2s, transform .1s;
      letter-spacing: 0.01em;
    }
    button:active {
      background: linear-gradient(90deg, #fc5c7d 0%, #6a82fb 100%);
      transform: scale(0.98);
    }
    button.connected {
      background: linear-gradient(90deg, #43e97b 0%, #38f9d7 100%);
      color: #22223b;
    }
    button.disconnect {
      background: #ffe3e3;
      color: #db2777;
      margin-top: 2px;
      margin-bottom: 10px;
      border: 1px solid #fecdd3;
    }
    .wallet-address {
      background: #f3eaff;
      padding: 7px 13px;
      border-radius: 5px;
      font-family: monospace;
      font-size: 1em;
      color: #4e4376;
      margin-bottom: 13px;
      text-align: center;
      word-break: break-all;
      letter-spacing: 0.01em;
      border: 1.5px solid #e0e0e0;
      box-shadow: 0 1.5px 6px #6a82fb22;
      display: block;
    }
    .signature-block {
      background: #f8fafc;
      border-radius: 7px;
      padding: 11px 13px;
      margin-top: 17px;
      box-shadow: 0 1.5px 6px #fc5c7d11;
      font-size: 0.99em;
      color: #2b5876;
      word-break: break-all;
      border: 1px solid #e0e0e0;
    }
    .error-block {
      color: #db2777;
      background: #ffe3e3;
      padding: 8px 14px;
      border-radius: 7px;
      margin-top: 11px;
      font-weight: 500;
      text-align: center;
      border: 1px solid #fecdd3;
      letter-spacing: 0.01em;
    }
    @media (max-width: 540px) {
      .main-card { padding: 18px 4vw 24px 4vw;}
      h2 { font-size: 1.23em;}
    }
  </style>
</head>
<body>
  <div class="main-card">
    <div class="logo-row">
      <img src="https://cryptologos.cc/logos/solana-sol-logo.png?v=026" alt="Solana" />
    </div>
    <h2>Solana Multi-Wallet Signing</h2>
    <div id="root"></div>
  </div>
  <script type="text/javascript">
    const { useState, useEffect } = React;
    const {
      PhantomWalletAdapter,
      SolflareWalletAdapter,
      TorusWalletAdapter,
      BackpackWalletAdapter,
      LedgerWalletAdapter,
      CoinbaseWalletAdapter,
      MathWalletAdapter,
      SolletExtensionWalletAdapter,
      SolletWalletAdapter,
    } = solanaWalletAdapterWallets;

    function App() {
      const [wallets, setWallets] = useState([]);
      const [selectedWalletIndex, setSelectedWalletIndex] = useState(null);
      const [adapter, setAdapter] = useState(null);
      const [publicKey, setPublicKey] = useState(null);
      const [connecting, setConnecting] = useState(false);
      const [message, setMessage] = useState("Hello Solana!");
      const [signature, setSignature] = useState("");
      const [error, setError] = useState("");

      useEffect(() => {
        setWallets([
          new PhantomWalletAdapter(),
          new SolflareWalletAdapter(),
          new TorusWalletAdapter(),
          new BackpackWalletAdapter(),
          new LedgerWalletAdapter(),
          new CoinbaseWalletAdapter(),
          new MathWalletAdapter(),
          new SolletExtensionWalletAdapter(),
          new SolletWalletAdapter(),
        ]);
      }, []);

      useEffect(() => {
        if (selectedWalletIndex !== null) {
          const wallet = wallets[selectedWalletIndex];
          setAdapter(wallet);
        }
      }, [selectedWalletIndex, wallets]);

      // Connect wallet
      const connectWallet = async () => {
        setError("");
        setSignature("");
        if (!adapter) return setError("Select a wallet first.");
        if (adapter.connected) {
          setPublicKey(adapter.publicKey?.toString());
          return;
        }
        setConnecting(true);
        try {
          await adapter.connect();
          setPublicKey(adapter.publicKey?.toString());
        } catch (e) {
          setError("Connection error: " + (e.message || e));
        }
        setConnecting(false);
      };

      // Disconnect wallet
      const disconnectWallet = async () => {
        if (adapter && adapter.disconnect) {
          await adapter.disconnect();
        }
        setPublicKey(null);
        setSignature("");
        setError("");
      };

      // Sign message
      const signMessage = async (e) => {
        e.preventDefault();
        setError("");
        setSignature("");
        if (!adapter || !adapter.connected) {
          return setError("Connect your wallet first.");
        }
        try {
          const encoder = new TextEncoder();
          const encoded = encoder.encode(message);
          const signed = await adapter.signMessage(encoded, 'utf8');
          const base64 = btoa(String.fromCharCode(...signed));
          setSignature(base64);
        } catch (e) {
          setError("Signing error: " + (e.message || e));
        }
      };

      return (
        React.createElement('div', null,
          React.createElement('div', { className: 'select-wallet-row' },
            React.createElement('label', { className: 'field-label' }, 'Select Wallet'),
            React.createElement('select', {
              value: selectedWalletIndex !== null ? selectedWalletIndex : "",
              onChange: e => {
                setSelectedWalletIndex(e.target.value !== "" ? Number(e.target.value) : null);
                setPublicKey(null);
                setSignature("");
                setError("");
                if (adapter && adapter.disconnect) adapter.disconnect();
              }
            },
              React.createElement('option', { value: "" }, "-- Choose a Wallet --"),
              wallets.map((w, i) =>
                React.createElement('option', { key: i, value: i }, w.name)
              )
            ),
            selectedWalletIndex !== null && React.createElement('button', {
              onClick: connectWallet,
              className: adapter && adapter.connected ? "connected" : "",
              style: {marginTop: 4},
              disabled: connecting || (adapter && adapter.connected)
            }, adapter && adapter.connected ? "Connected" : connecting ? "Connecting..." : "Connect"),
            adapter && adapter.connected && React.createElement('button', {
              onClick: disconnectWallet,
              className: "disconnect",
              type: "button"
            }, "Disconnect")
          ),
          publicKey && React.createElement('div', { className: "wallet-address" },
            publicKey
          ),
          React.createElement('form', { id: 'signForm', onSubmit: signMessage },
            React.createElement('label', { htmlFor: "message", className: "field-label" }, "Message to Sign"),
            React.createElement('input', {
              id: "message",
              type: "text",
              value: message,
              required: true,
              maxLength: 140,
              onChange: e => setMessage(e.target.value)
            }),
            React.createElement('button', { type: "submit", disabled: !publicKey }, "Sign Message")
          ),
          signature && React.createElement('div', { className: "signature-block" },
            React.createElement('div', { style: {fontWeight: 600, fontSize:'1em', marginBottom:3, color:'#4e4376'} }, "Signature (base64):"),
            React.createElement('div', null, signature)
          ),
          error && React.createElement('div', { className: "error-block" }, error)
        )
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
  </script>
</body>
</html>
